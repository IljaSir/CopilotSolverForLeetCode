Synthesizing 8/10 solutions (Duplicates hidden)

=======

        
    }
}

=======

        let n = nums.len();
        let mut dp = vec![vec![0; n]; 32];
        for i in 0..n {
            dp[0][i] = nums[i];
        }
        for i in 1..32 {
            for j in 0..n {
                if j + (1 << i) > n {
                    break;
                }
                dp[i][j] = dp[i - 1][j] | dp[i - 1][j + (1 << (i - 1))];
            }
        }
        let mut ans = vec![0; n];
        for i in 0..n {
            let mut l = 0;
            let mut r = n - i;
            while l < r {
                let mid = (l + r) / 2;
                if dp[31 - mid.leading_zeros() as usize][i] == (1 << 31) - 1 {
                    r = mid;
                } else {
                    l = mid + 1;
                }
            }
            ans[i] = l as i32;
        }
        ans
    }
}

=======

        let n = nums.len();
        let mut ans = vec![0; n];
        let mut stack = vec![];
        for i in 0..n {
            while !stack.is_empty() && stack[stack.len() - 1].1 <= nums[i] {
                stack.pop();
            }
            if !stack.is_empty() {
                let j = stack[stack.len() - 1].0;
                ans[j] = (i - j) as i32;
            }
            stack.push((i, nums[i]));
        }
        for j in 0..n {
            while !stack.is_empty() && stack[stack.len() - 1].1 <= nums[j] {
                stack.pop();
            }
            if !stack.is_empty() {
                let i = stack[stack.len() - 1].0;
                ans[j] = ans[j].min((i + n - j) as i32);
            }
            stack.push((j, nums[j]));
        }
        ans
